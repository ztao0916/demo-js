<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>iframe</title>
  <style>
    html {
      width: 100vw;
      height: 100vh;
    }

    body {
      padding: 0px;
      margin: 0px;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
    }

    #myiframe {
      border: 1px solid black;
      width: 90%;
      height: 90%;
    }

    .controller {
      width: 90%;
      height: 6%;
    }

    .translatebox {
      width: 320px;
      height: 150px;
      background: #f8f8f8;
      position: absolute;
      top: 45%;
      left: 45%;
      z-index: 999;
      display: none;
    }
  </style>
</head>

<body>
  <div class="controller">
    <div class="translatebox">
      <form action="">
        图片路径：<input type="text"
          value="https://img.alicdn.com/imgextra/i3/O1CN01F84hLR29Futc7Oshz_!!6000000008039-0-tps-750-1000.jpg"
          id="langInput" /><br />
        bizid：<input type="text" value="" id="bizid" /><br />

        源语言：<input type="radio" id="slang1" name="sourceLanguage" value="zh" onchange="getSourceLang()" />
        <label for="slang1">中文</label>
        <input type="radio" id="slang2" name="sourceLanguage" value="en" onchange="getSourceLang()" />
        <label for="slang2">英语</label><br />

        目标语言：<input type="radio" id="tlang1" name="targetLanguage" value="zh" onchange="getTargetLang()" />
        <label for="tlang1">中文</label>
        <input type="radio" id="tlang2" name="targetLanguage" value="en" onchange="getTargetLang()" />
        <label for="tlang2">英语</label>
        <input type="radio" id="tlang3" name="targetLanguage" value="pt" onchange="getTargetLang()" />
        <label for="tlang3">葡萄牙语</label>
        <input type="radio" id="tlang4" name="targetLanguage" value="es" onchange="getTargetLang()" />
        <label for="tlang4">西班牙语</label>
        <input type="radio" id="tlang5" name="targetLanguage" value="fr" onchange="getTargetLang()" />
        <label for="tlang5">法语</label>
        <input type="radio" id="tlang6" name="targetLanguage" value="ko" onchange="getTargetLang()" />
        <label for="tlang6">韩语</label>
        <input type="radio" id="tlang7" name="targetLanguage" value="ar" onchange="getTargetLang()" />
        <label for="tlang7">阿拉伯语</label>
        <input type="radio" id="tlang8" name="targetLanguage" value="tr" onchange="getTargetLang()" />
        <label for="tlang8">土耳其语</label><br />
        <button class="okBtn">确定</button>
      </form>
    </div>
    <button id="myBtn">切换</button>
    <br />
    <button id="ae">ae</button><button id="aib">aib</button><button id="aibcn">aibcn</button>
    <br />
    <button id="trial">trial</button><button id="notrial">notrial</button>
    <button id="langCH">中文</button><button id="langEN">英文</button>
  </div>
  <script>
    let iframeEle = null;
    let type = "banner";
    let baseUrl = "https://editor.d.design/editor/index.html/#/";
    let selectsLang = 'zh';
    let selecttLang = 'en';
    let apiHost = 'ae';
    let trial = true;
    let lang = 'zh-cn'; // 语言



    function getSourceLang () {
      var slang = document.getElementsByName("sourceLanguage");
      for (var i = 0; i < slang.length; i++) {
        if (slang[i].checked) {
          selectsLang = slang[i].value;
          break;
        }
      }
    }

    function getTargetLang () {
      var tlang = document.getElementsByName("targetLanguage");
      for (var i = 0; i < tlang.length; i++) {
        if (tlang[i].checked) {
          selecttLang = tlang[i].value;
          break;
        }
      }
    }

    const okBtn = document.querySelector(".okBtn");
    okBtn.onclick = handleLang;

    function getPageUrl () {
      if (type === "banner") {
        const payloadString = encodeURIComponent(
          JSON.stringify({
            apiHost,
            trial,
            productImageUrl:
              "https://piccopilot.oss-accelerate.aliyuncs.com/daily/compose/9227eba1-84fd-41b1-b598-63992a8bcacf.png?Expires=2018329037&OSSAccessKeyId=LTAI5t8wTopfofNtRDRrpsJY&Signature=NDZCqF1xULoN51A%2BgPHaROvVoTs%3D",
            sellingPointExtractionRequest: {
              productCategory: ["Home & Garden"],
              productTitle:
                "For Car 500ML 9H Hardness Car Detailing Ceramic Coating Car Products Car Accessories Nano Glass Voiture Plastic Restorer Tools",
              productDescription:
                "SpecificationProduct Name: Paint Crystal PlatingCapacity: 500mlMaterial: siliconStatus: Liquid hand sprayCuring speed: instant film formationConstruction method: one spray and one wipeScope of use: universal for all carsNotice1. Photos was been shoot based on real products and a professional camera, due to the light and the screen display being different, there will be a certain color, which can not be avoided, it is not a quality problem.2. Due to the personal measurement technique being different and the elastic fabric of the material/There may be a 1-inch error the physical, Please choose the size accordingly.",
            },
            lang: lang,
          }),
        );
        return `${baseUrl}banner?payload=${payloadString}`;
      } else if (type === "scene") {
        const payloadString = encodeURIComponent(
          JSON.stringify({
            apiHost,
            trial,
            url: "https://next-ubanner.oss-cn-beijing.aliyuncs.com/ALIWOOD_TEMPLATE/2020-06-03/test/data_plain.png",
            lang: lang,
          }),
        );
        return `${baseUrl}scene?payload=${payloadString}`;
      } else if (type === "clothes") {
        const payloadString = encodeURIComponent(
          JSON.stringify({
            apiHost,
            trial,
            url: "https://img.alicdn.com/imgextra/i3/O1CN01pDHDHn1rGE3Qfc9Ev_!!6000000005603-0-tps-750-1000.jpg",
            lang: lang,
          }),
        );
        return `${baseUrl}clothes?payload=${payloadString}`;
      } else if (type === "translate") {
        const langInput = document.getElementById('langInput').value;
        const bizidInput = document.getElementById('bizid').value;
        const payloadString = encodeURIComponent(
          JSON.stringify({
            apiHost,
            trial,
            imageUrl: langInput,
            sourceLanguage: selectsLang,
            targetLanguage: selecttLang,
            translatingTextInTheProduct: true,
            imageEditorId: bizidInput,
            lang: lang,
          }),
        );
        return `${baseUrl}translate?payload=${payloadString}`;
      } else if (type === "elimination") {
        const payloadString = encodeURIComponent(
          JSON.stringify({
            apiHost,
            trial,
            width: 800,
            height: 800,
            imageUrl: 'https://next-ubanner.oss-cn-beijing.aliyuncs.com/ALIWOOD_TEMPLATE/2020-06-03/test/test1.jpg',
            lang: lang,
          }),
        );
        return `${baseUrl}elimination?payload=${payloadString}`;
      }
    }
    function createIframe (src) {
      if (iframeEle) {
        document.body.removeChild(iframeEle);
      }
      iframeEle = document.createElement("iframe");
      iframeEle.src = src;
      iframeEle.className = "aidc-open-frame";
      iframeEle.id = "myiframe";
      iframeEle.frameborder = "0";
      document.body.insertBefore(iframeEle, document.body.children[0]);
    }
    // open sdk 扩展配置
    window.INTL_OP_FRAME_SDK_CONFIG = {
      // API 映射
      apiMap: {
        "/open/api/signature": "/mock/signature",
      },
    };

    var translatebox = document.querySelector('.translatebox');
    function handleLang (event) {
      translatebox.style.display = "none";
      type = 'translate';
      createIframe(getPageUrl());
      event.preventDefault();
    }

    createIframe(getPageUrl());
    function handleswitch () {
      if (type === "banner") {
        type = "scene";
      } else if (type === "scene") {
        type = "clothes";
      } else if (type === "clothes") {
        type = "translate"
      } else if (type === "translate") {
        type = "elimination";
      } else if (type === "elimination") {
        type = "banner";
      }
      createIframe(getPageUrl());
    }
    const myBtn = document.getElementById("myBtn");
    myBtn.onclick = handleswitch;

    const aeBtn = document.getElementById("ae");
    aeBtn.onclick = () => {
      apiHost = 'ae';
      createIframe(getPageUrl());
    };

    const aibBtn = document.getElementById("aib");
    aibBtn.onclick = () => {
      apiHost = 'aib';
      createIframe(getPageUrl());
    };

    const aibcnBtn = document.getElementById("aibcn");
    aibcnBtn.onclick = () => {
      apiHost = 'aibcn';
      createIframe(getPageUrl());
    };

    const trialBtn = document.getElementById("trial");
    trialBtn.onclick = () => {
      trial = true;
      createIframe(getPageUrl());
    };

    const notrialBtn = document.getElementById("notrial");
    notrialBtn.onclick = () => {
      trial = false;
      createIframe(getPageUrl());
    };

    const chLangBtn = document.getElementById("langCH");
    chLangBtn.onclick = () => {
      lang = 'zh-cn';
      createIframe(getPageUrl());
    };

    const enLangBtn = document.getElementById("langEN");
    enLangBtn.onclick = () => {
      lang = 'en-gb';
      createIframe(getPageUrl());
    };


    function handlemessage (list) {
      alert("收到图片消息：" + JSON.stringify(list));
    }

    window.addEventListener("message", (ev) => {
      console.log("---------------", ev.data);
      const { data, action } = ev.data;
      if (action === "submit") {
        handlemessage(data);
      } else if (action === "model") {
        translatebox.style.display = "block";
      }
    });

  </script>
  <script src="https://g.alicdn.com/code/npm/@ali/intl-op-frame-sdk/0.1.2/main.min.js"></script>
</body>
<chatgpt-sidebar data-gpts-theme="light"></chatgpt-sidebar><chatgpt-sidebar-popups
  data-gpts-theme="light"></chatgpt-sidebar-popups>

</html>